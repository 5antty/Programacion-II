ORG 1000H 	; Datos

CADENA DB "e4stE&3s.el.r3Ã§up3R@t0r1o"
VALOR_MIN DB 60H; VALOR MINIMO PARA SABER SI ES MINUSCULA
VALOR_MAX DB 7BH; VALOR MAXIMO PARA SABER SI ES MINUSCULA
VALOR_E DB "E"; DECALRO ESTA VARIABLE PARA COMPARAR ESTA LETRA CON UN CARACTER DE LA CADENA
CANT_E DB 0H; DECALRO ESTA VARIABLE PARA CONTAR LA CANTIDAD DE VECES QUE APARECE ESTA LETRA EN LA CADENA

ORG 3000H  ; Subrutina

MAYUS: PUSH AX
       PUSH BX
       PUSH CX; PUSH DE AX, BX, CX PARA REUTILIZAR LA SUBRUTINA
       MOV BX, SP
       ADD BX, 8
       MOV BX, [BX]
       MOV AX, BX; GUARDO EN AX LOS VALORES MAX Y MIN PARA SABER SI EL CARACTER ESTA EN MINUSCULA
       MOV BX, SP
       ADD BX, 10
       MOV BX, [BX]
       MOV CL, [BX]; GUARDO EN CL EL CARACTER RECIBIDO POR PILA Y REFERENCIA
       CMP AL, CL; COMPARO CON EL MINIMO PARA SABER SI ES MAYOR O IGUAL A "a"
       JNS FINR; SI EL CARACTER ES MENOR A "a" SALTO AL FIN DE LA SUBRUTINA
       CMP CL, AH; COMPARO CON EL MAXIMO PARA SABER SI ES MENOR O IGUAL A "z"
       JNS FINR; SI EL CARACTER ES MAYOR A "z" SALTO AL FIN DE LA SUBRUTINA
       SUB CL, 20h; CONVIERTO EL CARACTER EN MINUSCULA A MAYUSCULA
       MOV [BX], CL; GUARDO EL CARACTER EN MAYUSCULA EN LA DIRECCION DEL CARACTER
FINR:  POP CX
       POP BX
       POP AX; POPS DE LOS REGISTROS AX, BX, CX PARA DEJARLOS COMO ESTABAN ANTES DE LA SUBRUTINA
       RET


ORG 2000H   ; Programa Ppal.
       MOV DH, VALOR_E; LETRA A COMPARAR
       MOV DL, OFFSET VALOR_MIN - OFFSET CADENA; CANTIDAD DE ELEMENTOS DE LA CADENA
       MOV BX, OFFSET CADENA
       MOV CL, VALOR_MIN
       MOV CH, VALOR_MAX

BUCLE: CMP DL, 0
       JZ FIN
       PUSH BX; ENVIO LOS PARAMETROS A LA PILA POR REFERENCIA, LA DIR DEL CARACTER EN LA CADENA
       PUSH CX; 
       CALL MAYUS
       POP CX
       POP BX
       CMP [BX], DH; COMPARO EL CARACTER DE LA CADENA PROCESADO CON LA LETRA "E"
       JNZ SIGO
       INC AL; EN AL GUARDO LA CANTIDAD DE VECES QUE APARECE "E" EN LA CADENA
SIGO:  INC BX; INCREMENTO BX PARA TENER LOS SIGUIENTES VALORES DE LA CADENA
       DEC DL; DECREMENTO DL PARA SALIR DEL BUCLE
       JMP BUCLE

FIN:   MOV CANT_E, AL; GUARDO EN MEMORIA LA CANTIDAD DE VECES QUE APARACE "E" EN LA CADENA
       HLT
END